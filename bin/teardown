#!/bin/bash -eu

source $OPENSHIFT_CARTRIDGE_SDK_BASH

env_dir=${OPENSHIFT_HOMEDIR}/.env/user_vars
env_file_path=${env_dir}/JAVA_OPTS_EXT

if [ -f $env_file_path ]; then
  client_message ""
  client_message "Unset/adjust JAVA_OPTS_EXT environment variable."

  env_var_value=`echo $JAVA_OPTS_EXT | sed "s,${OPENSHIFT_NEWRELIC_AGENT_JAVA_OPTS},,"`

  if [ -z "${env_var_value}" ]; then
    rm -f ${env_file_path}
  else
    set_env_var 'JAVA_OPTS_EXT' "${env_var_value}" ${env_dir}
  fi
fi
